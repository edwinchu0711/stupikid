<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GitHub Actions ç•™è¨€æ¿</title>
  <style>
      * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
      }
      
      body {
          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          min-height: 100vh;
          padding: 20px;
      }
      
      .container {
          max-width: 900px;
          margin: 0 auto;
          background: white;
          border-radius: 15px;
          box-shadow: 0 10px 30px rgba(0,0,0,0.2);
          overflow: hidden;
      }
      
      .header {
          background: linear-gradient(45deg, #24292e, #586069);
          color: white;
          padding: 40px 30px;
          text-align: center;
      }
      
      .header h1 {
          font-size: 2.8em;
          margin-bottom: 10px;
          background: linear-gradient(45deg, #fff, #f0f6ff);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
      }
      
      .header p {
          opacity: 0.9;
          font-size: 1.2em;
      }
      
      .stats {
          display: flex;
          justify-content: center;
          gap: 30px;
          margin-top: 20px;
      }
      
      .stat-item {
          text-align: center;
      }
      
      .stat-number {
          font-size: 2em;
          font-weight: bold;
          color: #4CAF50;
      }
      
      .stat-label {
          font-size: 0.9em;
          opacity: 0.8;
      }
      
      .form-section {
          padding: 40px 30px;
          background: linear-gradient(135deg, #f8f9fa, #e9ecef);
          border-bottom: 1px solid #dee2e6;
      }
      
      .form-title {
          text-align: center;
          margin-bottom: 30px;
          color: #24292e;
          font-size: 1.8em;
      }
      
      .form-grid {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 20px;
          margin-bottom: 20px;
      }
      
      .form-group {
          margin-bottom: 20px;
      }
      
      .form-group.full-width {
          grid-column: 1 / -1;
      }
      
      .form-group label {
          display: block;
          margin-bottom: 8px;
          font-weight: 600;
          color: #24292e;
          font-size: 1.1em;
      }
      
      .form-group input,
      .form-group textarea {
          width: 100%;
          padding: 15px 18px;
          border: 2px solid #e1e4e8;
          border-radius: 10px;
          font-size: 16px;
          transition: all 0.3s ease;
          font-family: inherit;
      }
      
      .form-group input:focus,
      .form-group textarea:focus {
          outline: none;
          border-color: #0366d6;
          box-shadow: 0 0 0 4px rgba(3, 102, 214, 0.1);
          transform: translateY(-2px);
      }
      
      .form-group textarea {
          resize: vertical;
          min-height: 150px;
          line-height: 1.6;
      }
      
      .submit-btn {
          background: linear-gradient(45deg, #28a745, #20c997);
          color: white;
          padding: 15px 40px;
          border: none;
          border-radius: 10px;
          font-size: 18px;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.3s ease;
          display: block;
          margin: 0 auto;
          position: relative;
          overflow: hidden;
      }
      
      .submit-btn:hover {
          transform: translateY(-3px);
          box-shadow: 0 8px 25px rgba(40, 167, 69, 0.3);
      }
      
      .submit-btn:active {
          transform: translateY(-1px);
      }
      
      .submit-btn.loading {
          pointer-events: none;
          opacity: 0.8;
      }
      
      .submit-btn.loading::after {
          content: '';
          position: absolute;
          top: 50%;
          left: 50%;
          width: 20px;
          height: 20px;
          margin: -10px 0 0 -10px;
          border: 2px solid transparent;
          border-top: 2px solid white;
          border-radius: 50%;
          animation: spin 1s linear infinite;
      }
      
      @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
      }
      
      .messages-section {
          padding: 40px 30px;
      }
      
      .messages-title {
          text-align: center;
          margin-bottom: 30px;
          color: #24292e;
          font-size: 1.8em;
      }
      
      .message {
          background: linear-gradient(135deg, #ffffff, #f8f9fa);
          border: 1px solid #e1e4e8;
          border-radius: 15px;
          padding: 25px;
          margin-bottom: 25px;
          box-shadow: 0 4px 15px rgba(0,0,0,0.08);
          transition: all 0.3s ease;
          position: relative;
          overflow: hidden;
      }
      
      .message::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          width: 4px;
          height: 100%;
          background: linear-gradient(45deg, #667eea, #764ba2);
      }
      
      .message:hover {
          transform: translateY(-5px);
          box-shadow: 0 8px 30px rgba(0,0,0,0.15);
      }
      
      .message-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 15px;
          padding-bottom: 15px;
          border-bottom: 2px solid #f1f3f4;
      }
      
      .message-author {
          font-weight: 700;
          color: #0366d6;
          font-size: 1.2em;
      }
      
      .message-date {
          color: #586069;
          font-size: 0.95em;
          background: #f1f3f4;
          padding: 5px 12px;
          border-radius: 20px;
      }
      
      .message-content {
          color: #24292e;
          line-height: 1.8;
          font-size: 1.05em;
          word-wrap: break-word;
      }
      
      .loading-spinner {
          text-align: center;
          padding: 40px;
          color: #586069;
      }
      
      .loading-spinner::after {
          content: '';
          display: inline-block;
          width: 30px;
          height: 30px;
          border: 3px solid #f3f3f3;
          border-top: 3px solid #0366d6;
          border-radius: 50%;
          animation: spin 1s linear infinite;
          margin-left: 10px;
      }
      
      .no-messages {
          text-align: center;
          color: #586069;
          font-style: italic;
          padding: 60px;
          font-size: 1.2em;
      }
      
      .alert {
          padding: 15px 20px;
          margin: 20px 0;
          border-radius: 8px;
          font-weight: 500;
      }
      
      .alert.success {
          background: #d4edda;
          color: #155724;
          border: 1px solid #c3e6cb;
      }
      
      .alert.error {
          background: #f8d7da;
          color: #721c24;
          border: 1px solid #f5c6cb;
      }
      
      .github-info {
          background: linear-gradient(135deg, #f1f8ff, #e1f5fe);
          border: 2px solid #c8e1ff;
          border-radius: 12px;
          padding: 25px;
          margin: 30px;
          text-align: center;
      }
      
      .github-info h3 {
          color: #0366d6;
          margin-bottom: 15px;
          font-size: 1.4em;
      }
      
      .github-info p {
          color: #586069;
          margin-bottom: 20px;
          line-height: 1.6;
      }
      
      .github-link {
          display: inline-block;
          background: linear-gradient(45deg, #0366d6, #0256cc);
          color: white;
          padding: 12px 25px;
          text-decoration: none;
          border-radius: 8px;
          font-weight: 600;
          transition: all 0.3s ease;
      }
      
      .github-link:hover {
          transform: translateY(-2px);
          box-shadow: 0 5px 15px rgba(3, 102, 214, 0.3);
      }
      
      @media (max-width: 768px) {
          .container {
              margin: 10px;
              border-radius: 10px;
          }
          
          .header {
              padding: 30px 20px;
          }
          
          .header h1 {
              font-size: 2.2em;
          }
          
          .stats {
              gap: 20px;
          }
          
          .form-section,
          .messages-section {
              padding: 30px 20px;
          }
          
          .form-grid {
              grid-template-columns: 1fr;
              gap: 15px;
          }
          
          .github-info {
              margin: 20px;
              padding: 20px;
          }
      }
  </style>
</head>
<body>
  <div class="container">
      <div class="header">
          <h1>ğŸš€ GitHub Actions ç•™è¨€æ¿</h1>
          <p>ä½¿ç”¨ GitHub Actions è‡ªå‹•åŒ–è™•ç†çš„ç¾ä»£ç•™è¨€ç³»çµ±</p>
          <div class="stats">
              <div class="stat-item">
                  <div class="stat-number" id="messageCount">0</div>
                  <div class="stat-label">ç¸½ç•™è¨€æ•¸</div>
              </div>
              <div class="stat-item">
                  <div class="stat-number" id="todayCount">0</div>
                  <div class="stat-label">ä»Šæ—¥ç•™è¨€</div>
              </div>
          </div>
      </div>
      
      <div class="github-info">
          <h3>âš¡ æŠ€è¡“ç‰¹è‰²</h3>
          <p>é€™å€‹ç•™è¨€æ¿ä½¿ç”¨ GitHub Actions è‡ªå‹•åŒ–å·¥ä½œæµç¨‹ï¼Œå°‡ç•™è¨€å„²å­˜ç‚º JSON æ ¼å¼ï¼Œä¸¦é€é GitHub Pages å±•ç¤ºã€‚å®Œå…¨å…è²»ä¸”é–‹æºï¼</p>
          <a href="https://github.com/ä½ çš„ç”¨æˆ¶å/ä½ çš„å€‰åº«å" class="github-link" target="_blank">
              æŸ¥çœ‹åŸå§‹ç¢¼ â†’
          </a>
      </div>
      
      <div class="form-section">
          <h2 class="form-title">ğŸ’¬ ç™¼è¡¨ç•™è¨€</h2>
          <form id="messageForm">
              <div class="form-grid">
                  <div class="form-group">
                      <label for="name">ğŸ‘¤ å§“å *</label>
                      <input type="text" id="name" name="name" required placeholder="è«‹è¼¸å…¥ä½ çš„å§“å" maxlength="50">
                  </div>
                  
                  <div class="form-group">
                      <label for="email">ğŸ“§ Email (é¸å¡«)</label>
                      <input type="email" id="email" name="email" placeholder="your@email.com" maxlength="100">
                  </div>
              </div>
              
              <div class="form-group full-width">
                  <label for="message">ğŸ’­ ç•™è¨€å…§å®¹ *</label>
                  <textarea id="message" name="message" required placeholder="è«‹è¼¸å…¥ä½ çš„ç•™è¨€å…§å®¹..." maxlength="1000"></textarea>
              </div>
              
              <button type="submit" class="submit-btn" id="submitBtn">
                  ğŸ“¤ é€å‡ºç•™è¨€
              </button>
          </form>
          
          <div id="alertContainer"></div>
      </div>
      
      <div class="messages-section">
          <h2 class="messages-title">ğŸ’­ æœ€æ–°ç•™è¨€</h2>
          <div id="messagesList">
              <div class="loading-spinner">è¼‰å…¥ç•™è¨€ä¸­...</div>
          </div>
      </div>
  </div>
  
  <script>
      class GuestBook {
          constructor() {
              this.form = document.getElementById('messageForm');
              this.messagesList = document.getElementById('messagesList');
              this.submitBtn = document.getElementById('submitBtn');
              this.alertContainer = document.getElementById('alertContainer');
              
              this.init();
          }
          
          init() {
              this.loadMessages();
              this.bindEvents();
          }
          
          bindEvents() {
              this.form.addEventListener('submit', (e) => this.handleSubmit(e));
          }
          
          async loadMessages() {
              try {
                  // å¾ GitHub Pages è¼‰å…¥ç•™è¨€è³‡æ–™
                  const response = await fetch('./data/messages.json?t=' + Date.now());
                  const data = await response.json();
                  
                  this.renderMessages(data.messages);
                  this.updateStats(data.messages);
              } catch (error) {
                  console.error('è¼‰å…¥ç•™è¨€å¤±æ•—:', error);
                  this.messagesList.innerHTML = `
                      <div class="no-messages">
                          âŒ è¼‰å…¥ç•™è¨€å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦
                      </div>
                  `;
              }
          }
          
          renderMessages(messages) {
              if (!messages || messages.length === 0) {
                  this.messagesList.innerHTML = `
                      <div class="no-messages">
                          ğŸ“ é‚„æ²’æœ‰ç•™è¨€ï¼Œæˆç‚ºç¬¬ä¸€å€‹ç•™è¨€çš„äººå§ï¼
                      </div>
                  `;
                  return;
              }
              
              // æŒ‰æ™‚é–“å€’åºæ’åˆ—
              const sortedMessages = messages
                  .filter(msg => msg.approved !== false)
                  .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
              
              this.messagesList.innerHTML = sortedMessages
                  .map(message => this.createMessageHTML(message))
                  .join('');
          }
          
          createMessageHTML(message) {
              const date = new Date(message.timestamp);
              const formattedDate = date.toLocaleString('zh-TW', {
                  year: 'numeric',
                  month: '2-digit',
                  day: '2-digit',
                  hour: '2-digit',
                  minute: '2-digit'
              });
              
              return `
                  <div class="message">
                      <div class="message-header">
                          <span class="message-author">${this.escapeHtml(message.name)}</span>
                          <span class="message-date">${formattedDate}</span>
                      </div>
                      <div class="message-content">${this.escapeHtml(message.message).replace(/\n/g, '<br>')}</div>
                  </div>
              `;
          }
          
          updateStats(messages) {
              const approvedMessages = messages.filter(msg => msg.approved !== false);
              document.getElementById('messageCount').textContent = approvedMessages.length;
              
              const today = new Date().toDateString();
              const todayMessages = approvedMessages.filter(msg => 
                  new Date(msg.timestamp).toDateString() === today
              );
              document.getElementById('todayCount').textContent = todayMessages.length;
          }
          
          async handleSubmit(e) {
              e.preventDefault();
              
              const formData = new FormData(this.form);
              const messageData = {
                  name: formData.get('name').trim(),
                  email: formData.get('email').trim(),
                  message: formData.get('message').trim()
              };
              
              // é©—è­‰è³‡æ–™
              if (!this.validateMessage(messageData)) {
                  return;
              }
              
              this.setLoading(true);
              
              try {
                  // åœ¨å¯¦éš›æ‡‰ç”¨ä¸­ï¼Œé€™è£¡æœƒé€é GitHub API æˆ– webhook æäº¤è³‡æ–™
                  await this.submitMessage(messageData);
                  
                  this.showAlert('success', 'âœ… ç•™è¨€æäº¤æˆåŠŸï¼ç•™è¨€å°‡åœ¨å¯©æ ¸å¾Œé¡¯ç¤ºã€‚');
                  this.form.reset();
                  
                  // 3ç§’å¾Œé‡æ–°è¼‰å…¥ç•™è¨€
                  setTimeout(() => {
                      this.loadMessages();
                  }, 3000);
                  
              } catch (error) {
                  console.error('æäº¤ç•™è¨€å¤±æ•—:', error);
                  this.showAlert('error', 'âŒ æäº¤å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚');
              }
              
              this.setLoading(false);
          }
          
          async submitMessage(messageData) {
              // æ¨¡æ“¬ API å‘¼å«
              // åœ¨å¯¦éš›æ‡‰ç”¨ä¸­ï¼Œé€™è£¡æœƒï¼š
              // 1. å‘¼å« GitHub API å»ºç«‹ Issue
              // 2. æˆ–è€…é€é webhook è§¸ç™¼ GitHub Actions
              // 3. æˆ–è€…ä½¿ç”¨ç¬¬ä¸‰æ–¹æœå‹™å¦‚ Netlify Forms
              
              return new Promise((resolve, reject) => {
                  setTimeout(() => {
                      // æ¨¡æ“¬æˆåŠŸ/å¤±æ•—
                      if (Math.random() > 0.1) {
                          resolve();
                      } else {
                          reject(new Error('æ¨¡æ“¬éŒ¯èª¤'));
                      }
                  }, 2000);
              });
          }
          
          validateMessage(data) {
              if (!data.name || data.name.length < 2) {
                  this.showAlert('error', 'âŒ è«‹è¼¸å…¥è‡³å°‘ 2 å€‹å­—å…ƒçš„å§“å');
                  return false;
              }
              
              if (!data.message || data.message.length < 5) {
                  this.showAlert('error', 'âŒ ç•™è¨€å…§å®¹è‡³å°‘éœ€è¦ 5 å€‹å­—å…ƒ');
                  return false;
              }
              
              if (data.email && !this.isValidEmail(data.email)) {
                  this.showAlert('error', 'âŒ è«‹è¼¸å…¥æœ‰æ•ˆçš„ Email åœ°å€');
                  return false;
              }
              
              return true;
          }
          
          isValidEmail(email) {
              const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
              return emailRegex.test(email);
          }
          
          setLoading(loading) {
              if (loading) {
                  this.submitBtn.classList.add('loading');
                  this.submitBtn.textContent = 'æäº¤ä¸­...';
                  this.submitBtn.disabled = true;
              } else {
                  this.submitBtn.classList.remove('loading');
                  this.submitBtn.textContent = 'ğŸ“¤ é€å‡ºç•™è¨€';
                  this.submitBtn.disabled = false;
              }
          }
          
          showAlert(type, message) {
              this.alertContainer.innerHTML = `
                  <div class="alert ${type}">
                      ${message}
                  </div>
              `;
              
              // 5ç§’å¾Œè‡ªå‹•éš±è—
              setTimeout(() => {
                  this.alertContainer.innerHTML = '';
              }, 5000);
          }
          
          escapeHtml(text) {
              const div = document.createElement('div');
              div.textContent = text;
              return div.innerHTML;
          }
      }
      
      // åˆå§‹åŒ–ç•™è¨€æ¿
      document.addEventListener('DOMContentLoaded', () => {
          new GuestBook();
      });
  </script>
</body>
</html>
