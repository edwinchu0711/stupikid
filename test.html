<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GitHub Actions 留言板</title>
  <style>
      * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
      }
      
      body {
          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          min-height: 100vh;
          padding: 20px;
      }
      
      .container {
          max-width: 900px;
          margin: 0 auto;
          background: white;
          border-radius: 15px;
          box-shadow: 0 10px 30px rgba(0,0,0,0.2);
          overflow: hidden;
      }
      
      .header {
          background: linear-gradient(45deg, #24292e, #586069);
          color: white;
          padding: 40px 30px;
          text-align: center;
      }
      
      .header h1 {
          font-size: 2.8em;
          margin-bottom: 10px;
      }
      
      .header p {
          opacity: 0.9;
          font-size: 1.2em;
      }
      
      .github-info {
          background: linear-gradient(135deg, #f1f8ff, #e1f5fe);
          border: 2px solid #c8e1ff;
          border-radius: 12px;
          padding: 25px;
          margin: 30px;
          text-align: center;
      }
      
      .github-info h3 {
          color: #0366d6;
          margin-bottom: 15px;
          font-size: 1.4em;
      }
      
      .github-info p {
          color: #586069;
          margin-bottom: 20px;
          line-height: 1.6;
      }
      
      .form-section {
          padding: 40px 30px;
          background: linear-gradient(135deg, #f8f9fa, #e9ecef);
          border-bottom: 1px solid #dee2e6;
      }
      
      .form-title {
          text-align: center;
          margin-bottom: 30px;
          color: #24292e;
          font-size: 1.8em;
      }
      
      .form-grid {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 20px;
          margin-bottom: 20px;
      }
      
      .form-group {
          margin-bottom: 20px;
      }
      
      .form-group.full-width {
          grid-column: 1 / -1;
      }
      
      .form-group label {
          display: block;
          margin-bottom: 8px;
          font-weight: 600;
          color: #24292e;
          font-size: 1.1em;
      }
      
      .form-group input,
      .form-group textarea {
          width: 100%;
          padding: 15px 18px;
          border: 2px solid #e1e4e8;
          border-radius: 10px;
          font-size: 16px;
          transition: all 0.3s ease;
          font-family: inherit;
      }
      
      .form-group input:focus,
      .form-group textarea:focus {
          outline: none;
          border-color: #0366d6;
          box-shadow: 0 0 0 4px rgba(3, 102, 214, 0.1);
      }
      
      .form-group textarea {
          resize: vertical;
          min-height: 150px;
          line-height: 1.6;
      }
      
      .submit-btn {
          background: linear-gradient(45deg, #28a745, #20c997);
          color: white;
          padding: 15px 40px;
          border: none;
          border-radius: 10px;
          font-size: 18px;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.3s ease;
          display: block;
          margin: 0 auto;
      }
      
      .submit-btn:hover {
          transform: translateY(-3px);
          box-shadow: 0 8px 25px rgba(40, 167, 69, 0.3);
      }
      
      .github-submit-btn {
          background: linear-gradient(45deg, #0366d6, #0256cc);
          color: white;
          padding: 15px 40px;
          border: none;
          border-radius: 10px;
          font-size: 18px;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.3s ease;
          display: block;
          margin: 20px auto 0;
          text-decoration: none;
          text-align: center;
      }
      
      .github-submit-btn:hover {
          transform: translateY(-3px);
          box-shadow: 0 8px 25px rgba(3, 102, 214, 0.3);
      }
      
      .messages-section {
          padding: 40px 30px;
      }
      
      .messages-title {
          text-align: center;
          margin-bottom: 30px;
          color: #24292e;
          font-size: 1.8em;
      }
      
      .message {
          background: linear-gradient(135deg, #ffffff, #f8f9fa);
          border: 1px solid #e1e4e8;
          border-radius: 15px;
          padding: 25px;
          margin-bottom: 25px;
          box-shadow: 0 4px 15px rgba(0,0,0,0.08);
          transition: all 0.3s ease;
      }
      
      .message:hover {
          transform: translateY(-5px);
          box-shadow: 0 8px 30px rgba(0,0,0,0.15);
      }
      
      .message-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 15px;
          padding-bottom: 15px;
          border-bottom: 2px solid #f1f3f4;
      }
      
      .message-author {
          font-weight: 700;
          color: #0366d6;
          font-size: 1.2em;
      }
      
      .message-date {
          color: #586069;
          font-size: 0.95em;
          background: #f1f3f4;
          padding: 5px 12px;
          border-radius: 20px;
      }
      
      .message-content {
          color: #24292e;
          line-height: 1.8;
          font-size: 1.05em;
          word-wrap: break-word;
      }
      
      .alert {
          padding: 15px 20px;
          margin: 20px 0;
          border-radius: 8px;
          font-weight: 500;
      }
      
      .alert.info {
          background: #cce5ff;
          color: #004085;
          border: 1px solid #99d6ff;
      }
      
      .step-guide {
          background: #fff3cd;
          border: 1px solid #ffeaa7;
          border-radius: 10px;
          padding: 20px;
          margin: 20px 0;
      }
      
      .step-guide h4 {
          color: #856404;
          margin-bottom: 15px;
          font-size: 1.2em;
      }
      
      .step-guide ol {
          color: #856404;
          padding-left: 20px;
      }
      
      .step-guide li {
          margin-bottom: 8px;
          line-height: 1.5;
      }
      
      @media (max-width: 768px) {
          .container {
              margin: 10px;
              border-radius: 10px;
          }
          
          .header {
              padding: 30px 20px;
          }
          
          .header h1 {
              font-size: 2.2em;
          }
          
          .form-section,
          .messages-section {
              padding: 30px 20px;
          }
          
          .form-grid {
              grid-template-columns: 1fr;
              gap: 15px;
          }
          
          .github-info {
              margin: 20px;
              padding: 20px;
          }
      }
  </style>
</head>
<body>
  <div class="container">
      <div class="header">
          <h1>🚀 GitHub Actions 留言板</h1>
          <p>使用 GitHub Issues 處理留言的現代留言系統</p>
      </div>
      
      <div class="github-info">
          <h3>📋 如何留言？</h3>
          <p>填寫下方表單後，點擊「前往 GitHub 留言」按鈕，系統會自動產生 GitHub Issue 讓你提交留言。</p>
      </div>
      
      <div class="form-section">
          <h2 class="form-title">💬 準備留言</h2>
          <form id="messageForm">
              <div class="form-grid">
                  <div class="form-group">
                      <label for="name">👤 姓名 *</label>
                      <input type="text" id="name" name="name" required placeholder="請輸入你的姓名" maxlength="50">
                  </div>
                  
                  <div class="form-group">
                      <label for="email">📧 Email (選填)</label>
                      <input type="email" id="email" name="email" placeholder="your@email.com" maxlength="100">
                  </div>
              </div>
              
              <div class="form-group full-width">
                  <label for="message">💭 留言內容 *</label>
                  <textarea id="message" name="message" required placeholder="請輸入你的留言內容..." maxlength="1000"></textarea>
              </div>
              
              <button type="button" class="submit-btn" id="prepareBtn">
                  📝 準備留言
              </button>
              
              <a href="#" class="github-submit-btn" id="githubBtn" style="display: none;" target="_blank">
                  🚀 前往 GitHub 留言
              </a>
          </form>
          
          <div class="step-guide" id="stepGuide" style="display: none;">
              <h4>📋 留言步驟：</h4>
              <ol>
                  <li>點擊上方「前往 GitHub 留言」按鈕</li>
                  <li>在開啟的 GitHub 頁面中，確認留言內容</li>
                  <li>點擊「Submit new issue」提交</li>
                  <li>留言將會自動出現在下方列表中</li>
              </ol>
          </div>
          
          <div id="alertContainer"></div>
      </div>
      
      <div class="messages-section">
          <h2 class="messages-title">💭 最新留言</h2>
          <div id="messagesList">
              <div class="message">
                  <div class="message-header">
                      <span class="message-author">系統管理員</span>
                      <span class="message-date">2025-08-28 20:35</span>
                  </div>
                  <div class="message-content">
                      歡迎使用 GitHub Actions 留言板！這是一個示範留言。請按照上方步驟來提交你的留言。
                  </div>
              </div>
              
              <div class="alert info">
                  💡 <strong>提示：</strong>留言會透過 GitHub Issues 儲存，提交後需要等待 GitHub Actions 處理（通常幾分鐘內完成）。
              </div>
          </div>
      </div>
  </div>
  
  <script>
      document.addEventListener('DOMContentLoaded', function() {
          const form = document.getElementById('messageForm');
          const prepareBtn = document.getElementById('prepareBtn');
          const githubBtn = document.getElementById('githubBtn');
          const stepGuide = document.getElementById('stepGuide');
          const alertContainer = document.getElementById('alertContainer');
          
          // 請替換為你的實際 GitHub 資訊
          const GITHUB_USERNAME = '你的GitHub用戶名';  // 請修改這裡
          const REPO_NAME = '你的倉庫名';              // 請修改這裡
          
          prepareBtn.addEventListener('click', function() {
              const name = document.getElementById('name').value.trim();
              const email = document.getElementById('email').value.trim();
              const message = document.getElementById('message').value.trim();
              
              // 驗證表單
              if (!name || name.length < 2) {
                  showAlert('error', '❌ 請輸入至少 2 個字元的姓名');
                  return;
              }
              
              if (!message || message.length < 5) {
                  showAlert('error', '❌ 留言內容至少需要 5 個字元');
                  return;
              }
              
              if (email && !isValidEmail(email)) {
                  showAlert('error', '❌ 請輸入有效的 Email 地址');
                  return;
              }
              
              // 產生 GitHub Issue URL
              const issueTitle = `[留言] ${name} 的留言`;
              const issueBody = `## 📝 留言資訊

**姓名:** ${name}

**Email:** ${email || '未提供'}

**留言內容:**
${message}

---

> 💡 這是透過留言板自動產生的 Issue
> 🕒 提交時間: ${new Date().toLocaleString('zh-TW')}`;
              
              const githubUrl = `https://github.com/${GITHUB_USERNAME}/${REPO_NAME}/issues/new?` +
                  `title=${encodeURIComponent(issueTitle)}&` +
                  `body=${encodeURIComponent(issueBody)}&` +
                  `labels=guestbook-message`;
              
              githubBtn.href = githubUrl;
              githubBtn.style.display = 'block';
              stepGuide.style.display = 'block';
              
              showAlert('success', '✅ 留言準備完成！請點擊「前往 GitHub 留言」按鈕繼續。');
              
              // 滾動到 GitHub 按鈕
              githubBtn.scrollIntoView({ behavior: 'smooth', block: 'center' });
          });
          
          function showAlert(type, message) {
              const alertClass = type === 'error' ? 'alert error' : 'alert success';
              alertContainer.innerHTML = `
                  <div class="${alertClass}" style="background: ${type === 'error' ? '#f8d7da' : '#d4edda'}; color: ${type === 'error' ? '#721c24' : '#155724'}; border: 1px solid ${type === 'error' ? '#f5c6cb' : '#c3e6cb'}; padding: 15px; border-radius: 8px; margin: 15px 0;">
                      ${message}
                  </div>
              `;
              
              setTimeout(() => {
                  alertContainer.innerHTML = '';
              }, 5000);
          }
          
          function isValidEmail(email) {
              const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
              return emailRegex.test(email);
          }
          
          // 載入現有留言（從 GitHub Issues API）
          loadMessages();
          
          async function loadMessages() {
              try {
                  const response = await fetch(`https://api.github.com/repos/${GITHUB_USERNAME}/${REPO_NAME}/issues?labels=guestbook-message&state=closed`);
                  const issues = await response.json();
                  
                  if (issues && issues.length > 0) {
                      renderGitHubMessages(issues);
                  }
              } catch (error) {
                  console.log('載入 GitHub Issues 留言:', error);
                  // 不顯示錯誤，因為可能是倉庫還沒設定好
              }
          }
          
          function renderGitHubMessages(issues) {
              const messagesList = document.getElementById('messagesList');
              const existingAlert = messagesList.querySelector('.alert');
              
              const messagesHTML = issues.map(issue => {
                  const date = new Date(issue.created_at);
                  const formattedDate = date.toLocaleString('zh-TW');
                  
                  // 從 Issue body 中提取姓名和留言內容
                  const body = issue.body || '';
                  const nameMatch = body.match(/\*\*姓名:\*\*\s*(.+)/);
                  const messageMatch = body.match(/\*\*留言內容:\*\*\s*\n([\s\S]*?)(?:\n---|\n>|$)/);
                  
                  const name = nameMatch ? nameMatch[1].trim() : issue.user.login;
                  const message = messageMatch ? messageMatch[1].trim() : issue.title;
                  
                  return `
                      <div class="message">
                          <div class="message-header">
                              <span class="message-author">${escapeHtml(name)}</span>
                              <span class="message-date">${formattedDate}</span>
                          </div>
                          <div class="message-content">${escapeHtml(message).replace(/\n/g, '<br>')}</div>
                      </div>
                  `;
              }).join('');
              
              // 保留現有的系統留言和提示
              const systemMessage = messagesList.querySelector('.message');
              const systemMessageHTML = systemMessage ? systemMessage.outerHTML : '';
              const alertHTML = existingAlert ? existingAlert.outerHTML : '';
              
              messagesList.innerHTML = systemMessageHTML + messagesHTML + alertHTML;
          }
          
          function escapeHtml(text) {
              const div = document.createElement('div');
              div.textContent = text;
              return div.innerHTML;
          }
      });
  </script>
</body>
</html>
